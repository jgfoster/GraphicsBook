function injectBlockly(params = { width: 200, height: 500, before: '', after: '' }) {
	// var toolbox = document.getElementById("toolbox");

	const options = { 
		toolbox : graphicsToolbox(), 
		collapse : true, 
		comments : true, 
		disable : true, 
		maxBlocks : Infinity, 
		trashcan : true, 
		horizontalLayout : false, 
		toolboxPosition : 'start', 
		css : true, 
		media : '../script/blockly/msg/media/', 
		rtl : false, 
		scrollbars : true, 
		sounds : true, 
		oneBasedIndex : true
	};
	
	/* Inject your workspace */ 
	const workspace = Blockly.inject('blocklyDiv', options);
	
	/* Load Workspace Blocks from XML to workspace */
	const workspaceBlocks = document.getElementById("workspaceBlocks"); 
	Blockly.Xml.domToWorkspace(workspaceBlocks, workspace);

	function myUpdateFunction(event) {
		let source = `// graphics setup
const canvas = document.getElementById("canvas");
const graphics = canvas.getContext("2d");
graphics.setTransform(1, 0, 0, 1, 0, 0);
graphics.clearRect(0, 0, ` + params.width + `, ` + params.height + `);
graphics.fillStyle = "#F8F8F8";
graphics.fillRect(0, 0, ` + params.width + ', ' + params.height + `);
` + params.before + `// JavaScript generated by Blockly for HTML5 canvas
` + Blockly.JavaScript.workspaceToCode(workspace) + params.after;
		console.log(source);
		// document.getElementById('textarea').value = source;
		const block = Function(source);
		block();
	}
	
	workspace.addChangeListener(myUpdateFunction);
}
